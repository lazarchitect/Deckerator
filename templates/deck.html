
<html>
<head>
	<title>{{name}}</title>
	<link rel="stylesheet" href="/static/style.css">
	<link rel="icon" href="/static/favicon.png">
</head>
<body>

	<header>
		<a href="/" id="homebutton"> Home </a>
	</header>

	<br><br>

	<div id="content" style="margin-left: 10%;">

		<p>{{name}}</p>

		<div id="deck">



		</div>

		<script type="text/javascript">

			//CODE TO POPULATE DECK

			//TODO: ADD SECTIONS FOR CREATURE, ARTIFACT, ETC. AND POPULATE THOSE. JINJA NEEDS TO SEND THAT DATA TO THE CLIENT.

			var deckdiv = document.getElementById('deck');
			var decklistObj = JSON.parse({{ deck|tojson|safe }});
			var cardInfoObj = JSON.parse({{ info|tojson|safe }});
			
			//decklistObj is a list of card:count pairs
			//cardInfoObj is a list of card:info_list pairs

			for(var card in decklistObj){
				// console.log(cardInfoObj[card]);
				// if(cardInfoObj[card][2].includes("Creature")){
				deckdiv.innerText += decklistObj[card] + " " + card + "\n";
				// }
			}


			//send in a form with the deck's name to a flask page
			//so flask can retrive deck from DB and do something with it
			function formsubmit (action) {
				var submitForm = document.createElement("form");
					submitForm.setAttribute("action", action);
					submitForm.setAttribute("method", "post");
					submitForm.setAttribute("style", "display: none;");

				var deckname = document.createElement("input");
					deckname.setAttribute("type", "text");
					deckname.setAttribute("name", "name");
					deckname.setAttribute("value", "{{name}}");
					deckname.setAttribute("style", "display: none;");

				var deckOwner = document.createElement("input");
					deckOwner.setAttribute("type", "text");
					deckOwner.setAttribute("name", "deckOwner");
					deckOwner.setAttribute("value", "{{deckOwner}}");
					deckOwner.setAttribute("style", "display: none;");	

				submitForm.appendChild(deckname);
				submitForm.appendChild(deckOwner);
				
				document.body.appendChild(submitForm);
				submitForm.submit();
			}


			function editdeck () {
				// redirect to edit deck page
				// needs deck name and session userid so python can fetch the deck
				formsubmit("/editdeck");
			}
			
			function deletedeck(){
				if (confirm("Are you sure you want to delete this deck?")){
					formsubmit("/deletedeck");
				}
			}

		</script>


		{% if owner %}
			<button onclick="editdeck()"> Edit Deck </button>

			<button onclick="deletedeck()"> Delete Deck </button>
		{% endif %}

	</div>

	<div id="footer">
		<div id="footertext"> Questions? Found a Bug? Want to Contribute? Contact: Eddie Lazar -> eddie.lazar@yahoo.com</div>
	</div>


</body>
</html>